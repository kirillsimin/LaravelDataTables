{"version":3,"sources":["app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["$(document).ready(function () {\n\n    /**\n    * Bands datatable\n    *****************************************************************/\n    var bandsTable = $('#bands').DataTable({\n        processing: true,\n        serverSide: true,\n        ajax: {\n            url: window.location.origin + '/bands/data',\n        },\n        columns: [\n            {data: 'name', name: 'bands.name'},\n            {data: 'start_date', name: 'bands.start_date'},\n            {data: 'website', name: 'bands.website'},\n            {data: 'still_active', name: 'bands.still_active', searchable: false},\n            {data: 'action', name: 'action', orderable: false, searchable: false}\n        ]\n    });\n\n    /**\n    * Albums datatable\n    *****************************************************************/\n    var albumsTable = $('#albums').DataTable({\n        processing: true,\n        serverSide: true,\n        ajax: {\n            url: window.location.origin + '/albums/data',\n            data: function (d) {\n                d.band_id = $('#band-search').val();\n            }\n        },\n        columns: [\n            {data: 'band', name: 'band_id'},\n            {data: 'name', name: 'name'},\n            {data: 'recorded_date', name: 'recorded_date'},\n            {data: 'release_date', name: 'release_date'},\n            {data: 'number_of_tracks', name: 'number_of_tracks'},\n            {data: 'label', name: 'label'},\n            {data: 'producer', name: 'producer'},\n            {data: 'genre', name: 'genre'},\n            {data: 'action', name: 'action', orderable: false, searchable: false}\n        ]\n    });\n\n    $('#band-search').off('select2:select', function(){});\n    $('#band-search').on('select2:select', function(e){\n        e.preventDefault();\n        albumsTable.draw();\n    });\n\n    /**\n    * Albums Select 2\n    *****************************************************************/\n    $('.band-search').select2({\n        minimumInputLength: 3,\n        placeholder: \"Select band...\",\n        ajax: {\n            url: '/bands/search',\n            method: 'post',\n            dataType: 'json',\n            delay: 250,\n            data: function (params) {\n                var token = $('input[name=\"_token\"]').val();\n                return {\n                    term: params.term, // search term\n                    role_id: 2,\n                    _token: token\n                };\n            },\n            processResults: function (data) {\n                return {\n                    results: data\n                };\n            }\n        }\n    });\n\n    /**\n    * Delete Band\n    *****************************************************************/\n    $(document).off('click', '.delete-band');\n    $(document).on('click', '.delete-band', function() {\n        var bandId = $(this).data('band-id');\n        $('.warning-modal-yes').off('click');\n        $('.warning-modal-yes').on('click', function() {\n            var token = $('input[name=\"_token\"]').val();\n            $.ajax({\n                url: '/bands/delete',\n                method: 'post',\n                data: {\n                    _token: token,\n                    band_id: bandId\n                },\n                dataType: 'json'\n            })\n            .always(function(){\n                $('#warning-modal').find('.message').html('');\n            })\n            .done(function(data){\n                console.log(data);\n                if (data.success == true) {\n                    $('#warning-modal').modal('hide');\n                    bandsTable.draw();\n                }\n                if (data.success == false) {\n                    console.log(data.message);\n                    $('#warning-modal').find('.message').html(data.message);\n                }\n            })\n            .fail(function(data){\n                $('#warning-modal').find('.message').html('Unexpected error occured.');\n                response = JSON.parse(data.responseText);\n                console.log(data, response);\n\n            });\n        });\n    });\n\n    /**\n    * Delete Album\n    *****************************************************************/\n    $(document).off('click', '.delete-album');\n    $(document).on('click', '.delete-album', function() {\n        var albumId = $(this).data('album-id');\n        $('.warning-modal-yes').off('click');\n        $('.warning-modal-yes').on('click', function() {\n            var token = $('input[name=\"_token\"]').val();\n            $.ajax({\n                url: '/albums/delete',\n                method: 'post',\n                data: {\n                    _token: token,\n                    album_id: albumId\n                },\n                dataType: 'json'\n            })\n            .always(function(){\n                $('#warning-modal').find('.message').html('');\n            })\n            .done(function(data){\n                console.log(data);\n                if (data.success == true) {\n                    $('#warning-modal').modal('hide');\n                    albumsTable.draw();\n                }\n                if (data.success == false) {\n                    console.log(data.message);\n                    $('#warning-modal').find('.message').html(data.message);\n                }\n            })\n            .fail(function(data){\n                $('#warning-modal').find('.message').html('Unexpected error');\n                response = JSON.parse(data.responseText);\n                console.log(data, response);\n            });\n        });\n    });\n\n});"]}